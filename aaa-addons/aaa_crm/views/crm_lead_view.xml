<?xml version="1.0"?>
<odoo>
    <data>

    <record id="crm_axes_form_view" model="ir.ui.view">
        <field name="name">crm.axes.form.</field>
        <field name="model">crm.axes</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                <group>
                    <group>
                        <field name="name"/>
                        <field name="axe_type"/>
                    </group>
                    <group>
                        <field name="company_ids" widget="many2many_tags" attrs="{'invisible': [('axe_type','!=','axe5')]}"/>
                    </group>
                </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="crm_axes_tree_view" model="ir.ui.view">
        <field name="name">crm.axes.tree.</field>
        <field name="model">crm.axes</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="axe_type"/>
            </tree>
        </field>
    </record>


       <record id="action_crm_axe" model="ir.actions.act_window">
           <field name="name">CRM axes</field>
           <field name="res_model">crm.axes</field>
           <field name="view_mode">tree,form</field>
       </record>

        <menuitem id="crm_axe_menu_config"
            name="Axes"
            parent="crm.crm_menu_config"
            action="action_crm_axe"
            sequence="10"/>

    <record id="crm_case_form_view_oppor" model="ir.ui.view">
        <field name="name">crm.lead.form.opportunity</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">
            <field name="user_id" position="before">
                <field name="end_lead"/>
                <field name="axe1" widget="selection" required="True" domain="[('axe_type','=','axe1')]"/>
                <field name="axe2" widget="selection" required="True" domain="[('axe_type','=','axe2')]"/>
            </field>
            <field name="priority" position="before">
                <field name="axe3" widget="selection" required="True" domain="[('axe_type','=','axe3')]"/>
                <field name="axe4" widget="selection" required="True" domain="[('axe_type','=','axe4')]"/>
                <field name="user_is_subdomain" invisible="1"/>
                <field name="company_id" invisible="1"/>
                <field name="axe5" widget="selection" attrs="{'required': [('user_is_subdomain', '=',True)]}" domain="[('axe_type','=','axe5'),'|',('company_ids','in',[company_id]),('company_ids','=',False)]" groups="aaa_crm.axe5_sous_domain"/>
            </field>
	<xpath expr="//sheet//div[2]" position="replace">
              <div class="badge-pill badge-danger float-right" attrs="{'invisible': [ ('probability', '&gt;', 0)]}">Lost</div>
            </xpath>
        </field>
    </record>
	
    <record id="crm_case_kanban_view_leads_all" model="ir.ui.view">
        <field name="name">crm.lead.kanban.lead</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads"/>
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="attributes">
                <attribute name="create">true</attribute>
                <attribute name="quick_create">false</attribute>
            </xpath>
        </field>
    </record>
<record id="crm_lead_search_field" model="ir.ui.view">
        <field name="name">crm.lead.search.filter</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_leads_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='lost']" position="replace">
		    <filter string="Lost" name="lost" domain="[ ('probability', '=', 0)]"/>
            </xpath>
        </field>
    </record>

    <record id="res_config_settings_auto_view_form" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.crm.auto</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="crm.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@id='crm_lead']" position="after">
                    <div class="o_setting_left_pane"/>
                    <div class="o_setting_right_pane">
                        <label string="Automatic stage" for="auto_stage"/>
                        <div class="content-group">
                            <div class="mt16">
                                <field name="stage_auto_id" widget="selection" class="col-lg-16"/>
                            </div>
                        </div>
                   </div>
            </xpath>
        </field>
    </record>

<!--     <record id="view_crm_case_opportunities_filter" model="ir.ui.view">-->
<!--        <field name="name">crm.lead.search.opportunity.axe1</field>-->
<!--        <field name="model">crm.lead</field>-->
<!--        <field name="inherit_id" ref="crm.res_config_settings_view_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <field name="date_conversion" position="after">-->
<!--                    <field name="axe1" string="axe1" filter_domain="[('axe1', 'ilike', self)]"/>-->
<!--                    <field name="axe2" string="axe1" filter_domain="[('axe2', 'ilike', self)]"/>-->
<!--                    <field name="axe3" string="axe3" filter_domain="[('axe3', 'ilike', self)]"/>-->
<!--                    <field name="axe4" string="axe4" filter_domain="[('axe4', 'ilike', self)]"/>-->
<!--                    <field name="axe5" string="axe5" filter_domain="[('axe5', 'ilike', self)]"/>-->
<!--            </field>-->
<!--        </field>-->
<!--     </record>-->

    <record id="crm_opportunity_action_crm_kpi_company" model="ir.actions.act_window">
        <field name="name">KPI  cabinets</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">pivot</field>
        <field name="view_id" ref=""/>
        <field name="domain">[('active','in',[True, False])]</field>
        <field name="context">{'add_company':True}</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

        <record id="crm_opportunity_action_crm_kpi_partner" model="ir.actions.act_window">
        <field name="name">KPI  clients</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">pivot</field>
        <field name="view_id" ref=""/>
        <field name="domain">[('active','in',[True, False])]</field>
        <field name="context">{'add_partner':True}</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
    </record>

         <!-- Top menu item -->
      <menuitem name="KPI"
          id="menu_kpi_root"
          web_icon="aaa_crm,static/description/odoo_icon.png"
          sequence="500"
                groups="aaa_crm.crm_kpi_groupe"/>

<!--        <menuitem-->
<!--    name="KPI  clients"-->
<!--    action="aaa_crm.crm_opportunity_action_crm_kpi_partner"-->
<!--    id="menu_crm_kpi_partner"-->
<!--    parent="aaa_crm.menu_kpi_root"-->
<!--    groups="aaa_crm.crm_kpi_groupe"-->
<!--    sequence="2"-->
<!--    />-->

<!--    <menuitem-->
<!--    name="KPI  cabinets"-->
<!--    action="aaa_crm.crm_opportunity_action_crm_kpi_company"-->
<!--    id="menu_crm_kpi_company"-->
<!--    parent="aaa_crm.menu_kpi_root"-->
<!--    groups="aaa_crm.crm_kpi_groupe"-->
<!--    sequence="1"-->
<!--    />-->


    </data>
</odoo>
